(function(e,t,r){function s(e,t,r,s,a,d){this.divId=e,this.className=t,this.metricName=r,this.max=s,this.title=a,this.type=d,this.getMax=function(){return this.max},this.getMetricNode=function(e,t,r){return r[e]?r[e][t]:null}}function a(e,t){var r=100*(e/t);return r.toFixed(0)}function d(e,t){return t||(t=1),e.toFixed(t)}function n(e){return e.charAt(0).toUpperCase()+e.slice(1)}function i(e,t,r,a,d,n,i,o){var l=new s(e,t,r,a,d,"timer");return l.getMeterInfo=function(){var e=this.divId+" div.timerGraph td.meterGraph",t=new s(e,this.className,this.metricName,this.max,"Frequency","meter");return t.getMetricNode=function(e,t,r){return r[e]?r[e][t].rate:null},t.eventType=n,t},l.getTimerStatsDivId=function(){return"#"+this.divId+" div.timerGraph td.timerStatsGraph"},l.getTimerHistogramDivId=function(){return"#"+this.divId+" div.timerGraph td.timerHistogram"},l.durationMax=i,l.isNested=o,l}function o(e){var r=t("#"+e.divId),s="<div class='metricsWatcher counter counterGraph'><h3>"+e.title+"</h3><div class='progress'><div class='bar' style='width: 0%;'></div></div></div>";r.html(s)}function l(e,r){var s=e.getMetricNode(e.className,e.metricName,r),d=a(s.count,e.getMax(r));t("#"+e.divId+" div.progress div.bar").css("width",d+"%"),t("#"+e.divId+" div.progress div.bar").html(s.count+"/"+e.getMax(r))}function m(e){var r=t("#"+e.divId),s=e.isNested?" nested":"",a="<div class='metricsWatcher timer timerGraph"+s+"'>"+"<fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='timerContainer span12'>"+"<table><tr>"+"<td class='meterGraph span4'></td>"+"<td class='timerStatsGraph span4'></td>"+"<td class='timerHistogram span4'></td>"+"</tr></table></div></fieldset>";r.html(a),f(e.getMeterInfo()),c(e),u(e)}function c(e){var r="<h3>Duration</h3><p></p><div class='metricGraph'><table class='progressTable'>"+w("Min","min")+w("Mean","mean")+w("Median","median")+w("Max","max")+w("Std&nbsp;Dev","std_dev")+"</table></div>",s=t(e.getTimerStatsDivId());s.html(r)}function u(e){var r="<h3>Histogram</h3><p>Percentiles</p><div class='metricGraph'><table class='progressTable'>"+w("99.9%","p999")+w("99%","p99")+w("98%","p98")+w("95%","p95")+w("75%","p75")+"</table></div>",s=t(e.getTimerHistogramDivId());s.html(r)}function h(e,t){b(e.getMeterInfo(),t),p(e,t),g(e,t)}function p(e,r){var s=e.getMetricNode(e.className,e.metricName,r);if(s){var a=s.duration,d=t(e.getTimerStatsDivId()+" p");d.html(n(a.unit)),v(e.getTimerStatsDivId(),a,"min",e.durationMax),v(e.getTimerStatsDivId(),a,"mean",e.durationMax),v(e.getTimerStatsDivId(),a,"median",e.durationMax),v(e.getTimerStatsDivId(),a,"max",e.durationMax),v(e.getTimerStatsDivId(),a,"std_dev",e.durationMax)}}function v(e,r,s,n){t(e+" tr."+s+" td.progressValue").html(d(r[s])),t(e+" tr."+s+" td.progressBar div.progress div.bar").css("width",a(r[s],n)+"%")}function g(e,t){var r=e.getMetricNode(e.className,e.metricName,t);if(r){var s=r.duration;v(e.getTimerHistogramDivId(),s,"p999",e.durationMax),v(e.getTimerHistogramDivId(),s,"p99",e.durationMax),v(e.getTimerHistogramDivId(),s,"p98",e.durationMax),v(e.getTimerHistogramDivId(),s,"p95",e.durationMax),v(e.getTimerHistogramDivId(),s,"p75",e.durationMax)}}function f(e){var r=t("#"+e.divId),s="<div class='metricsWatcher metric metricGraph'><h3>"+e.title+"</h3><p></p><table class='progressTable'>"+w("1&nbsp;min","onemin")+w("5&nbsp;min","fivemin")+w("15&nbsp;min","fifteenmin")+w("Mean","mean")+"</table></div>";r.html(s)}function w(e,t){return"<tr class='"+t+"'><td class='progressLabel'>"+e+"</td>"+"<td class='progressBar'><div class='progress'><div class='bar' style='width: 0%;'></div>"+"</div></td><td class='progressValue'>0</td></tr>"}function b(e,t){var r=e.getMetricNode(e.className,e.metricName,t);r&&I(e,r)}function I(e,r){var s=t("#"+e.divId+" p"),a=e.eventType;a||(a=r.event_type),r.count>1&&"get"===a?a="gets":r.count>1&&"put"===a&&(a="puts");var d=r.unit;"seconds"===d&&(d="second"),s.html(a+" per "+d+" ("+r.count+" total)"),y(e,r,"mean","mean"),y(e,r,"m1","onemin"),y(e,r,"m5","fivemin"),y(e,r,"m15","fifteenmin")}function y(e,r,s,n){t("#"+e.divId+" tr."+n+" td.progressValue").html(d(r[s])),t("#"+e.divId+" tr."+n+" td.progressBar div.progress div.bar").css("width",a(r[s],e.max)+"%")}function M(e){var r=t("#"+e.divId),s="<div class='metricsWatcher metric metricGraph'><h3>"+e.title+"</h3><h1></h1></div>";r.html(s)}function S(e,t){var r=e.getMetricNode(e.className,e.metricName,t);r&&C(e,r)}function C(e,r){var s=t("#"+e.divId+" h1");s.html(r.value)}function T(e,r){var s=t("#"+e),a="<div class='metricsWatcher metric metricGraph nested'><fieldset><legend><h1>"+r+"</h1></legend>"+"<div class='gaugeTableContainer'><table class='gaugeTable'></table></div></fieldset></div>";s.html(a)}function G(e,r,s){for(var a=t("#"+e+" table"),d="",n=r.length,i=0;n>i;i++){var o=r[i];d+="<tr><td><h5>"+o.title+"</h5></td>"+"<td><h4>"+o.getMetricNode(o.className,o.metricName,s).value+"</h4></td></tr>"}a.html(d)}function N(e){var r=t("#"+e.divId),s="<div class='metricsWatcher cache cacheGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='cacheContainer span12'>"+"	<div class='row-fluid'>"+"		<div class='span3'><div id='"+e.divId+"Statistics'></div></div>"+"		<div class='span9'>"+"			<div id='"+e.divId+"gettimer'></div>"+"			<div id='"+e.divId+"puttimer'></div>"+"		</div>"+"	</div>"+"</div></fieldset></div>";r.html(s);for(var a=e.components.gauges.length,d=0;a>d;d++)M(e.components.gauges[d]);m(e.getTimer),m(e.putTimer),T(e.divId+"Statistics","Statistics",e.components.gauges)}function x(e,r){for(var s=e.components.gauges.length,a=0;s>a;a++){var d=e.components.gauges[a],n=d.getMetricNode(e.className,d.metricName,r);if(n){var i=t("#"+d.divId+" div.metricGraph h1");i.html(n.value)}}h(e.getTimer,r),h(e.putTimer,r),G(e.divId+"Statistics",e.components.gauges,r)}function j(e){var r=t("#"+e.divId),s="<div class='metricsWatcher jvm metricGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='jvmContainer span12'>"+"	<div id='"+e.divId+"Vm'></div>"+"</div>"+"</fieldset></div>";r.html(s)}function H(e,r){var s=t("#"+e.divId+"Vm"),a=r[e.className],n="<div class='row-fluid'><div class='span3'><table class='jvmTable'><tr><td class='rowName'><h5>Name</h5></td><td>"+a.vm.name+"</td></tr>"+"<tr><td><h5>Version</h5></td><td>"+a.vm.version+"</td></tr>"+"<tr><td><h5>Current Time</h5></td><td>"+a.current_time+"</td></tr>"+"<tr><td><h5>Uptime</h5></td><td>"+a.uptime+"</td></tr>"+"<tr><td><h5>FD Usage</h5></td><td>"+d(a.fd_usage,2)+"</td></tr>"+"<tr><td><h5>Daemon Threads</h5></td><td>"+a.daemon_thread_count+"</td></tr>"+"<tr><td><h5>Threads</h5></td><td>"+a.thread_count+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Total Init</h5></td><td>"+a.memory.totalInit+"</td></tr>"+"<tr><td><h5>Total Used</h5></td><td>"+a.memory.totalUsed+"</td></tr>"+"<tr><td><h5>Total Max</h5></td><td>"+a.memory.totalMax+"</td></tr>"+"<tr><td><h5>Total Committed</h5></td><td>"+a.memory.totalCommitted+"</td></tr>"+"<tr><td><h5>Heap Init</h5></td><td>"+a.memory.heapInit+"</td></tr>"+"<tr><td><h5>Heap Used</h5></td><td>"+a.memory.heapUsed+"</td></tr>"+"<tr><td><h5>Heap Max</h5></td><td>"+a.memory.heapMax+"</td></tr>"+"<tr><td><h5>Heap Committed</h5></td><td>"+a.memory.heapCommitted+"</td></tr>"+"<tr><td><h5>Heap Usage</h5></td><td>"+d(a.memory.heap_usage,2)+"</td></tr>"+"<tr><td><h5>Non Heap Usage</h5></td><td>"+d(a.memory.non_heap_usage,2)+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Code Cache</h5></td><td>"+d(a.memory.memory_pool_usages["Code Cache"],2)+"</td></tr>"+"<tr><td><h5>PS Eden Space</h5></td><td>"+d(a.memory.memory_pool_usages["PS Eden Space"],2)+"</td></tr>"+"<tr><td><h5>PS Old Gen</h5></td><td>"+d(a.memory.memory_pool_usages["PS Old Gen"],2)+"</td></tr>"+"<tr><td><h5>PS Perm Gen</h5></td><td>"+d(a.memory.memory_pool_usages["PS Perm Gen"],2)+"</td></tr>"+"<tr><td><h5>PS Survivor Space</h5></td><td>"+d(a.memory.memory_pool_usages["PS Survivor Space"],2)+"</td></tr>"+"<tr><td><h5>PS Mark Sweep Runs</h5></td><td>"+a["garbage-collectors"]["PS MarkSweep"].runs+"</td></tr>"+"<tr><td><h5>PS Mark Sweep Time</h5></td><td>"+a["garbage-collectors"]["PS MarkSweep"].time+"</td></tr>"+"<tr><td><h5>PS Scavenge Runs</h5></td><td>"+a["garbage-collectors"]["PS Scavenge"].runs+"</td></tr>"+"<tr><td><h5>PS Scavenge Time</h5></td><td>"+a["garbage-collectors"]["PS Scavenge"].time+"</td></tr>"+"</table></div>"+"<div class='span3'><table class='jvmTable'>"+"<tr><td><h5>Terminated</h5></td><td>"+a["thread-states"].terminated+"</td></tr>"+"<tr><td><h5>Timed Waiting</h5></td><td>"+d(a["thread-states"].timed_waiting,2)+"</td></tr>"+"<tr><td><h5>Blocked</h5></td><td>"+d(a["thread-states"].blocked,2)+"</td></tr>"+"<tr><td><h5>Waiting</h5></td><td>"+d(a["thread-states"].waiting,2)+"</td></tr>"+"<tr><td><h5>Runnable</h5></td><td>"+d(a["thread-states"].runnable,2)+"</td></tr>"+"<tr><td><h5>New</h5></td><td>"+a["thread-states"]["new"]+"</td></tr>"+"</table></div></div>";s.html(n)}function D(e){var r=t("#"+e.divId),s="<div class='metricsWatcher web metricGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='webContainer span12'>"+"	<div id='"+e.divId+"Web'></div>"+"<table><tr>"+"<td colspan='4' class='requestsGraph span12'></td>"+"</tr><tr>"+"<td class='activeRequestsGraph span3'></td>"+"<td class='responseCodesOkGraph span3'></td>"+"<td class='responseCodesCreatedGraph span3'></td>"+"<td class='responseCodesOtherGraph span3'></td>"+"</tr><tr>"+"<td class='responseCodesBadRequestGraph span3'></td>"+"<td class='responseCodesNoContentGraph span3'></td>"+"<td class='responseCodesNotFoundGraph span3'></td>"+"<td class='responseCodesServerErrorGraph span3'></td>"+"</tr></table>"+"</div>"+"</fieldset></div>";r.html(s),m(e.components.requestsInfo),o(e.components.activeRequestsInfo);for(var a=e.components.meters.length,d=0;a>d;d++)f(e.components.meters[d])}function _(e,t){h(e.components.requestsInfo,t),l(e.components.activeRequestsInfo,t);for(var r=e.components.meters.length,s=0;r>s;s++)b(e.components.meters[s],t)}function q(e){var r=t("#"+e.divId),s="<div class='metricsWatcher log4j metricGraph span12'><fieldset><legend><h1>"+e.title+"</h1></legend>"+"<div class='log4jContainer span12'>"+"	<div id='"+e.divId+"Log4j'></div>"+"<table><tr>"+"<td colspan='4' class='span12'></td>"+"</tr><tr>"+"<td class='all span3'></td>"+"<td class='fatal span3'></td>"+"<td class='error span3'></td>"+"<td class='warn span3'></td>"+"</tr><tr>"+"<td class='info span3'></td>"+"<td class='debug span3'></td>"+"<td class='trace span3'></td>"+"</tr></table>"+"</div>"+"</fieldset></div>";r.html(s);for(var a=e.components.meters.length,d=0;a>d;d++)f(e.components.meters[d])}function P(e,t){for(var r=e.components.meters.length,s=0;r>s;s++)b(e.components.meters[s],t)}e.addGauge=function(e,t,r,a){var d=new s(e,t,r,null,a,"gauge");R.push(d)},e.addMeter=function(e,t,a,d,n,i){i==r&&(i="Calls");var o=new s(e,t,a,d,n,"meter");o.eventType=i,R.push(o)},e.addCounter=function(e,t,r,a,d){var n=new s(e,t,r,a,d,"counter");R.push(n)},e.addLinkedCounter=function(e,t,r,a,d,n){var i=new s(e,t,r,null,n,"counter");i.maxClassName=a,i.maxMetricName=d,i.getMax=function(e){var t=this.getMetricNode(this.maxClassName,this.maxMetricName,e);return t.count},R.push(i)},e.addTimer=function(e,t,r,s,a,d,n){var o=i(e,t,r,s,a,d,n,!1);R.push(o)},e.addCache=function(e,t,r){var a=new s(e,t,null,null,r,"cache");a.components={gauges:[new s(null,t,"hits",null,"Hits","gauge"),new s(null,t,"misses",null,"Misses","gauge"),new s(null,t,"objects",null,"Objects","gauge"),new s(null,t,"eviction-count",null,"Eviction Count","gauge"),new s(null,t,"in-memory-hits",null,"In Memory Hits","gauge"),new s(null,t,"in-memory-misses",null,"In Memory Misses","gauge"),new s(null,t,"in-memory-objects",null,"In Memory Objects","gauge"),new s(null,t,"off-heap-hits",null,"Off Heap Hits","gauge"),new s(null,t,"off-heap-misses",null,"Off Heap Misses","gauge"),new s(null,t,"off-heap-objects",null,"Off Heap Objects","gauge"),new s(null,t,"on-disk-hits",null,"On Disk Hits","gauge"),new s(null,t,"on-disk-misses",null,"On Disk Misses","gauge"),new s(null,t,"on-disk-objects",null,"On Disk Objects","gauge"),new s(null,t,"mean-get-time",null,"Mean Get Time","gauge"),new s(null,t,"mean-search-time",null,"Mean Search Time","gauge"),new s(null,t,"searches-per-second",null,"Searches Per Sec","gauge"),new s(null,t,"writer-queue-size",null,"Writer Queue Size","gauge"),new s(null,t,"accuracy",null,"Accuracy","gauge")]},a.getTimer=i(e+"gettimer",t,"get",1e3,"Get","get",1e3,!0),a.putTimer=i(e+"puttimer",t,"put",1e3,"Put","put",1e4,!0),R.push(a)},e.addJvm=function(e,t,r){var a=new s(e,t,null,null,r,"jvm");R.push(a)},e.addWeb=function(e,t,r){var a=new s(e,t,null,null,r,"web");a.components={meters:[new s(e+" td.responseCodesOkGraph",t,"responseCodes.ok",10,"OK Responses","meter"),new s(e+" td.responseCodesBadRequestGraph",t,"responseCodes.badRequest",10,"Bad Requests","meter"),new s(e+" td.responseCodesCreatedGraph",t,"responseCodes.created",10,"Created Responses","meter"),new s(e+" td.responseCodesNoContentGraph",t,"responseCodes.noContent",10,"No Content Responses","meter"),new s(e+" td.responseCodesNotFoundGraph",t,"responseCodes.notFound",10,"Not Found Responses","meter"),new s(e+" td.responseCodesOtherGraph",t,"responseCodes.other",10,"Other Responses","meter"),new s(e+" td.responseCodesServerErrorGraph",t,"responseCodes.serverError",10,"Server Error Responses","meter")],activeRequestsInfo:new s(e+" td.activeRequestsGraph",t,"activeRequests",10,"Active Requests","counter"),requestsInfo:i(e+" td.requestsGraph",t,"requests",100,"Requests","requests",100,!0)},R.push(a)},e.addLog4j=function(e,t,r){var a=new s(e,t,null,null,r,"log4j");a.components={meters:[new s(e+" td.all",t,"all",100,"all","meter"),new s(e+" td.fatal",t,"fatal",100,"fatal","meter"),new s(e+" td.error",t,"error",100,"error","meter"),new s(e+" td.warn",t,"warn",100,"warn","meter"),new s(e+" td.info",t,"info",100,"info","meter"),new s(e+" td.debug",t,"debug",100,"debug","meter"),new s(e+" td.trace",t,"trace",100,"trace","meter")]},R.push(a)},e.initGraphs=function(){for(var e=0;e<R.length;e++)R[e].type=="gauge"?M(R[e]):R[e].type=="meter"?f(R[e]):R[e].type=="counter"?o(R[e]):R[e].type=="timer"?m(R[e]):R[e].type=="cache"?N(R[e]):R[e].type=="jvm"?j(R[e]):R[e].type=="web"?D(R[e]):R[e].type=="log4j"?q(R[e]):alert("Unknown meter info type: "+R[e].type)},e.updateGraphs=function(e){for(var t=0;t<R.length;t++)R[t].type=="gauge"?S(R[t],e):R[t].type=="meter"?b(R[t],e):R[t].type=="counter"?l(R[t],e):R[t].type=="timer"?h(R[t],e):R[t].type=="cache"?x(R[t],e):R[t].type=="jvm"?H(R[t],e):R[t].type=="web"?_(R[t],e):R[t].type=="log4j"?P(R[t],e):alert("Unknown meter info type: "+R[t].type)};var R=[]})(window.metricsWatcher=window.metricsWatcher||{},jQuery);